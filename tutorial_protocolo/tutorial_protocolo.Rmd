---
title: "Memorial Descritivo e Levantamento Topográfico no Dabukuri App"
author: "Cassiano"
output: 
  html_document:
    code_folding: show
    fig_width: 6
    fig_height: 4
    theme:
      bootswatch: "flatly"
      base_font:
        google: Prompt
      heading_font:
        google: Proza Libre
---

```{r setup, include=FALSE}
if (requireNamespace("thematic")) 
  thematic::thematic_rmd(font = "auto")

# former yaml theme config
# bg: "#202123"
#       fg: "#B8BCC2"
#       primary: "#EA80FC"
#       secondary: "#00DAC6"

```
<div align: 'right'> <img width = 140px src = "DABUKURI.png" /></div>

### Introdução

Neste tutorial vou ilustrar o protocolo que desenvolvi para gerar dois documentos de geo-referenciamento para o projeto __Direito ao Território - Humanitas FAPEAM__, que usa os programas de código aberto 1) [QGIS](https://qgis.org/en/site/) para fazer a representação espacial geo-referenciada dos lotes, que inclui o desenho de polígonos e extração de pontos extremos, distâncias e áreas, e 2) o app baseado em [R-Shiny](https://shiny.posit.co) para gerar os documentos baseados em _templates_ [RMarkdow](https://rmarkdown.rstudio.com) em formato _HTML_ (que podem ser impressos em _PDF_ no seu browser).


### QGIS

#### Polígonos e pontos limites dos terrenos
1. Exporte seus pontos de referência de campo coletados na comunidade (como *.shp*) e dê um zoom para a camada carregada no QGIS.
2. Se você não tiver todos os pontos de interesse coletados, abra uma imagem georeferenciada de sobrevôo de avião ou drone, ou uma base de imagens atual que mostre os lotes em estudo (e.g. Navegador/ XYZ Tiles/ Google, OpenStreetMap, etc). A imagem de *background* ajuda muito de qualquer forma.

3. Crie uma nova camada vetorial de polígono (Camada/ Criar nova camada/ Nova camada shapefile -> escolha o nome, e.g. tutorial_lotes.shp). Use as configurações UTF-8, polígono, epsg 4326 WGS84 (graus) ou epsg 3857 WGS84 PseudoMercator (metros) e inclua os campos na tabela de acordo com a Figura 1.

<div class = "container"> 
<img width = 70% src = "fig_new_shp.png">

Figura 1. Criando polígono vetorial no QGIS
</div>

4. Habilite a edição clicando com o botão direito sobre a camada (Alternar edição - veja que o lápis aparece junto ao ícone na barra de camadas - Figura 2) e utilize o botão de _Adicionar polígono_ (Figura 2, em azul). O outros botões da barra de vetorização são também usados para habilitar e desabilitar edição (vermelho) e salvar (verde).

<div class = "container"> 
<img width = 90% src = "botoes.png">

Figura 2. Habilite a edição vetorial no QGIS
</div>

5. Crie os polígonos, um a um: com o mouse no exato local clique no primeiro ponto extremo do lote (ponto 1), desloque até o segundo e clique (ponto 2), e assim sucessivamente - quando tiver concluído clique botão direito. Preencha o formulário com os dados disponíveis a respeito deste lote com o cuidado de gerar um único número de identificação (Figura 3). Este formulário preenche a tabela que será utilizada como base para todas as etapas futuras. Crie outros polígonos de outros lotes da mesma forma.

<div class = "container"> 
<img width = 90% src = "cria_poligono.png">

Figura 3. Desenho do primeiro polígono e formulário de atributos
</div>

Se você for utilizar um shapefile já existente (e sua respectiva tabela, por exemplo [aqui](https://github.com/cassianogatto/Memorial_descritivo/blob/main/Dabukuri_espacial/TABELA%20GERAL.csv)), basta habilitar a edição e continuar preenchendo a tabela nesta nova comunidade.

É sempre bom lembrar que todas as informações necessárias para que os _templates_ dos documentos possam ser preenchidos são obtidos desta tabela, que é a fonte de dados dos proprietários, de endereço, dos pontos demarcadores dos terrenos, do comprimento dos lados, área, etc. (Figura 4). No modo edição a tabela pode ser editada - lembre-se sempre de salvar as alterações.

<div class = "container"> 
<img width = 90% src = "tabela.png">

Figura 3. Tabela de atributos
</div>



1. Abra a camada no GQGIS (versão > 3.28) (Camada/Adicionar camada/Adicionar camada vetorial -> fonte -> escolha a camada '.shp'). Clique com o botão direito em "Abrir tabela de atributos"; verifique as colunas
2. Baixe seus pontos de referência de campo coletados na comunidade.
3. Abra na 
4. 






Para gerar o 'Memorial Descritivo' e o 'Levantamento Topográfico', abaixo, é utilizada 










This is an R Markdown document themed with [`{bslib}` package](https://rstudio.github.io/bslib/). `{bslib}` makes it easy to customize the main colors and fonts of a `html_document`, [`flexdashboard::flex_dashboard`](https://flexdashboard-pkg.netlify.app/articles/articles/theme.html), [shiny::fluidPage()](https://shiny.rstudio.com/reference/shiny/latest/fluidPage.html), or more generally any website that uses [Bootstrap](https://getbootstrap.com/) for styling. The `theme` parameter in the yaml front-matter of this Rmd document describes a [`bslib::bs_theme()`](https://rstudio.github.io/bslib/reference/bs_theme.html) object, which provides access to 100s of [theming options](https://rstudio.github.io/bslib/articles/bs5-variables.html) (via its `...` argument) in addition to the main options demonstrated here (e.g., `bg`, `fg`, `primary`, etc).

This particular example uses `{bslib}`'s default [Bootstrap version (which, at the time of writing, is Bootstrap 5)](https://rstudio.github.io/bslib/articles/bslib.html#versions). However, if reproducibility is important, it's recommended that you "lock-in" the version by adding `version: 5` to the `theme` definition.

## Themed Plots {.tabset .tabset-pills}

When running this document with [`{thematic}`](https://rstudio.github.io/thematic/) installed, the `thematic::thematic_rmd(font = "auto")` effectively translates `theme` (CSS) settings to new global theming defaults for `{ggplot2}`, `{lattice}`, and `{base}` R graphics:

### ggplot2

```{r}
library(ggplot2)

ggplot(mpg, aes(displ, hwy)) +
  geom_point() + geom_smooth()
```

### lattice

```{r}
lattice::show.settings()
```

### base

```{r}
plot(pressure, col = thematic::thematic_get_option("accent"))
```
